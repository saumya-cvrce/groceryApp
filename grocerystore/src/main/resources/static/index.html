<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Management</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { max-width: 800px; margin: auto; padding: 20px; }
        .category { margin-bottom: 20px; }
        .category h2 { background-color: #f4f4f4; padding: 10px; }
        label { display: inline-block; width: 120px; margin-top: 10px; }
        .summary { background-color: #f4f4f4; padding: 10px; }
        button { margin-top: 10px; }
	.red-text {
        font-size: 12px;
        color: red;}
	.order-button:hover {
	      background-color: darkgreen;
	 }
    
	
    </style>
	
</head>
<body>
    <div class="container">
        <h1>Order Management</h1>
		<form id="orderForm">
        <div class="category" id="breadCategory">
            <h2>Breads</h2>
            <label for="breadQuantity">Quantity:</label>
            <input type="number" id="breadQuantity" min="1" value="3"><br>

            <label for="breadAge">Bread Age (days):</label>
            <input type="number" id="breadAge" min="0" value="3"><br>

            <p class="red-text">*Offer Buy 1 Take 2 or Buy 2 Take 3 </p> 
        </div>

        <div class="category" id="vegetableCategory">
            <h2>Vegetables</h2>
            <label for="vegetableWeight">Weight (grams):</label>
            <input type="number" id="vegetableWeight" min="0" value="200"><br>

            <p class="red-text">*Offer 0g-100g 5% 100g-500g 7% More than 500g </p> 

        </div>

        <div class="category" id="beerCategory">
            <h2>Beers</h2>
            <label for="beerType">Beer Type:</label>
            <select id="beerType">
                <option value="Belgium">Belgium</option>
                <option value="Dutch">Dutch</option>
                <option value="German">German</option>
            </select><br>

            <label for="beerQuantity">Quantity (multiples of 6):</label>
            <input type="number" id="beerQuantity" min="0" step="6" value="6"><br>

            <p class="red-text">*Offer Pack of (6) Belgium(€3,00) Dutch(€2,00) German(€4,00) </p> 

        </div>
				<button type="submit">Place Order</button><br><br>
		</form>

		<h2>Order Summary</h2>
		<div id="orderSummary"></div>

	
		<script>
		    document.addEventListener("DOMContentLoaded", function() {
		        const orderForm = document.getElementById("orderForm");

		        if (orderForm) {
		            orderForm.addEventListener("submit", function(event) {
		                event.preventDefault();

		                const orderRequest = {items:[
		                    { type: "bread", name: "Bread", quantity: breadQuantity.value, ageInDays: breadAge.value },
		                    { type: "vegetable", name: "Vegetable",weight: vegetableWeight.value },
		                    { type: "beer", name: "Beer", quantity: beerQuantity.value, origin: beerType.value }
		                ]};

						   // Make the REST API call to place the order
						            fetch('http://localhost:7070/api/order', {
						                method: 'POST',
						                headers: {
						                    'Content-Type': 'application/json'
						                },
						                body: JSON.stringify(orderRequest) 
						            })
						            .then(response => {
						                if (!response.ok) {
						                    throw new Error("Network response was not ok");
						                }
						                return response.json();
						            })
						            .then(data => {
						                console.log(data);  
						                
						                const itemPrices = data.itemPrices;

						                let summaryHtml = `
										    <p>Bread €1,00, Veg €1,00 per 100g, Beer €0,50 per bottle</p>
										    <ul>
										        ${Object.keys(itemPrices).map((item, index) => {
										            return `<li>${index + 1}. ${item} €${itemPrices[item].toFixed(2)}</li>`;
										        }).join('')}
										    </ul>
										    <p><strong>Total:</strong> €${data.totalPrice.toFixed(2)}</p>
										`;
						                
						                document.getElementById('orderSummary').innerHTML = summaryHtml;
						            })
						            .catch(error => {
						                console.error('Error while placing the order:', error);
						                document.getElementById('orderSummary').innerHTML = '<p>An error occurred while placing the order.</p>';
						            });
						        });
						    } else {
						        console.error("Order form element not found");
						    }
						});
							</script>
</body>
</html>
